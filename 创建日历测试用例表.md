# 飞书"创建共享日历"接口自动化测试用例表

## 一、权限与认证校验阶段

| 用例ID          | 用例名称         | 前置条件                                                     | 操作步骤                                                     | 预期结果                                                     |
| :-------------- | :--------------- | :----------------------------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| TC_CAL_AUTH_001 | 应用身份创建日历 | 1. 应用已开启机器人能力 2. 拥有有效的tenant_access_token 3. 应用具有calendar:calendar:create权限 | 1. 构造请求头：Authorization="Bearer {有效tenant_token}" 2. Content-Type="application/json; charset=utf-8" 3. 构造请求体：summary="测试日历" 4. 发送POST请求到/calendar/v4/calendars | HTTP 200，code=0，msg="success"，data.calendar包含calendar_id，type="shared"，role="owner" |
| TC_CAL_AUTH_002 | 用户身份创建日历 | 1. 拥有有效的user_access_token 2. 用户具有calendar:calendar:create权限 | 1. 构造请求头：Authorization="Bearer {有效user_token}" 2. 构造请求体：summary="个人测试日历" 3. 发送POST请求 | HTTP 200，code=0，msg="success"，data.calendar包含calendar_id，type="shared"，role="owner" |
| TC_CAL_AUTH_003 | Token格式错误    | 1. 使用无效格式的token                                       | 1. 构造请求头：Authorization="InvalidTokenFormat" 2. 构造正常请求体 3. 发送POST请求 | HTTP 401，错误码提示token格式错误                            |

## 二、参数边界校验阶段

| 用例ID           | 用例名称                     | 前置条件                           | 操作步骤                                                     | 预期结果                                                    |
| :--------------- | :--------------------------- | :--------------------------------- | :----------------------------------------------------------- | :---------------------------------------------------------- |
| TC_CAL_PARAM_001 | summary参数-正常长度         | 1. 具有创建权限 2. 准备有效的token | 1. 构造请求体：summary为255个字符的字符串 2. 发送POST请求    | HTTP 200，日历创建成功，summary正确返回                     |
| TC_CAL_PARAM_002 | summary参数-超过最大长度     | 1. 具有创建权限                    | 1. 构造请求体：summary为256个字符的字符串 2. 发送POST请求    | HTTP 400，错误码190002，提示"invalid parameters in request" |
| TC_CAL_PARAM_003 | description参数-正常长度     | 1. 具有创建权限                    | 1. 构造请求体：description为255个字符的字符串 2. 发送POST请求 | HTTP 200，日历创建成功，description正确返回                 |
| TC_CAL_PARAM_004 | description参数-超过最大长度 | 1. 具有创建权限                    | 1. 构造请求体：description为256个字符的字符串 2. 发送POST请求 | HTTP 400，错误码190002                                      |
| TC_CAL_PARAM_005 | permissions参数-有效枚举值   | 1. 具有创建权限                    | 1. 分别测试permissions="private"、"show_only_free_busy"、"public" 2. 发送POST请求 | HTTP 200，日历创建成功，permissions正确返回                 |
| TC_CAL_PARAM_006 | permissions参数-无效枚举值   | 1. 具有创建权限                    | 1. 构造请求体：permissions="invalid_value" 2. 发送POST请求   | HTTP 400，错误码190002                                      |
| TC_CAL_PARAM_007 | color参数-有效范围值         | 1. 具有创建权限                    | 1. 构造请求体：color=-1（示例值） 2. 发送POST请求            | HTTP 200，日历创建成功，color正确返回                       |

## 三、业务功能与逻辑阶段

| 用例ID         | 用例名称               | 前置条件            | 操作步骤                                                     | 预期结果                                                     |
| :------------- | :--------------------- | :------------------ | :----------------------------------------------------------- | :----------------------------------------------------------- |
| TC_CAL_BUS_001 | 创建日历使用默认值     | 1. 具有创建权限     | 1. 构造请求体：只传必填参数或不传任何参数（所有参数可选） 2. 发送POST请求 | HTTP 200，日历创建成功，使用默认值：summary为空，description为空，permissions="show_only_free_busy"，color=-14513409，summary_alias为空 |
| TC_CAL_BUS_002 | 应用创建日历自动订阅   | 1. 应用具有创建权限 | 1. 应用身份创建日历 2. 查询该应用的日历订阅列表              | 新建的日历在订阅列表中，role="owner"                         |
| TC_CAL_BUS_003 | 创建不同公开范围的日历 | 1. 具有创建权限     | 1. 分别创建private、show_only_free_busy、public三种权限的日历 2. 验证每种日历的访问权限 | HTTP 200，每种权限的日历都能成功创建，且权限设置正确         |

暂不考虑:

1、日历个数上限

## 四、组合覆盖用例

| 用例ID          | 用例名称                   | 前置条件            | 操作步骤                                                     | 预期结果                                 |
| :-------------- | :------------------------- | :------------------ | :----------------------------------------------------------- | :--------------------------------------- |
| TC_CAL_COMB_001 | 组合1：应用身份+完整参数   | 1. 应用具有创建权限 | 1. 使用tenant_access_token 2. 构造完整请求体：summary="测试"，description="描述"，permissions="private"，color=-1，summary_alias="别名" 3. 发送POST请求 | HTTP 200，日历创建成功，所有参数正确返回 |
| TC_CAL_COMB_002 | 组合2：用户身份+仅必填参数 | 1. 用户具有创建权限 | 1. 使用user_access_token 2. 构造请求体：summary="个人日历"（其他参数不传） 3. 发送POST请求 | HTTP 200，日历创建成功，使用默认值       |
| TC_CAL_COMB_003 | 组合3：应用身份+边界值组合 | 1. 应用具有创建权限 | 1. 使用tenant_access_token 2. 构造请求体：summary=255字符，description=255字符，permissions="public"，color=0，summary_alias=255字符 3. 发送POST请求 | HTTP 200，日历创建成功                   |

## 五、异常处理

| 用例ID           | 用例名称         | 前置条件        | 操作步骤                                                     | 预期结果                                               |
| :--------------- | :--------------- | :-------------- | :----------------------------------------------------------- | :----------------------------------------------------- |
| TC_CAL_LIMIT_001 | Content-Type错误 | 1. 具有创建权限 | 1. 设置Content-Type="text/plain" 2. 构造正常请求体 3. 发送POST请求 | HTTP 400，错误码提示Content-Type必须是application/json |
| TC_CAL_LIMIT_002 | 请求体格式错误   | 1. 具有创建权限 | 1. 构造请求体：非JSON格式字符串 2. 发送POST请求              | HTTP 400，错误码190002                                 |

